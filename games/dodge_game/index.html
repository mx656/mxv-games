<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dodge Game</title>
<style>
body {
  background: #1e1e1e;
  color: white;
  font-family: Arial, sans-serif;
  text-align: center;
  margin: 0;
  padding: 0;
}
#gameContainer {
  position: relative;
  width: 500px;
  height: 500px;
  margin: 50px auto;
  border: 3px solid #fff;
  background: #2e2e2e;
  overflow: hidden;
  border-radius: 10px;
}
#player {
  position: absolute;
  width: 50px;
  height: 50px;
  background: #4caf50;
  bottom: 10px;
  left: 225px;
  border-radius: 10px;
  transition: transform 0.1s;
}
.obstacle {
  position: absolute;
  width: 50px;
  height: 50px;
  background: red;
  border-radius: 10px;
}
.particle {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  pointer-events: none;
  animation: particleAnim 0.6s forwards;
}
@keyframes particleAnim {
  0% { transform: translate(0,0); opacity:1; }
  100% { transform: translate(var(--dx), var(--dy)); opacity:0; }
}
h1, h2 { margin: 10px; }
#startButton {
  padding: 10px 20px;
  font-size: 18px;
  cursor: pointer;
  margin-top: 20px;
}
</style>
</head>
<body>

<h1>ðŸš¨ Dodge Game</h1>
<h2>Score: <span id="score">0</span> | High Score: <span id="highScore">0</span></h2>
<div id="gameContainer">
  <div id="player"></div>
</div>
<button id="startButton">Start Game</button>

<!-- Sounds -->
<audio id="dingSound" src="https://freesound.org/data/previews/341/341695_5260875-lq.mp3"></audio>
<audio id="hitSound" src="https://freesound.org/data/previews/82/82587_1022651-lq.mp3"></audio>

<script>
const gameContainer = document.getElementById('gameContainer');
const player = document.getElementById('player');
const startButton = document.getElementById('startButton');
const dingSound = document.getElementById('dingSound');
const hitSound = document.getElementById('hitSound');

let score = 0;
let highScore = localStorage.getItem('dodgeHighScore') || 0;
document.getElementById('highScore').innerText = highScore;

let gameInterval, obstacleInterval;
let obstacles = [];
let gameRunning = false;
let playerSpeed = 10;
let obstacleSpeed = 4;

// Start game
function startGame() {
  score = 0;
  obstacles.forEach(o => o.element.remove());
  obstacles = [];
  document.getElementById('score').innerText = score;
  startButton.style.display = 'none';
  player.style.left = '225px';
  player.style.transform = 'scale(1)';
  gameRunning = true;
  obstacleSpeed = 4;

  obstacleInterval = setInterval(createObstacle, 1000);
  gameInterval = setInterval(gameLoop, 20);
}

// Create obstacle
function createObstacle() {
  const obs = document.createElement('div');
  obs.classList.add('obstacle');
  obs.style.left = Math.random() * (gameContainer.clientWidth - 50) + 'px';
  obs.style.top = '0px';
  gameContainer.appendChild(obs);
  obstacles.push({element: obs, y: 0});
}

// Game loop
function gameLoop() {
  if (!gameRunning) return;

  obstacles.forEach((o, index) => {
    o.y += obstacleSpeed;
    o.element.style.top = o.y + 'px';

    if (isColliding(player, o.element)) {
      collisionEffect(player);
      endGame();
    }

    if (o.y > gameContainer.clientHeight) {
      o.element.remove();
      obstacles.splice(index, 1);
      score += 1;
      document.getElementById('score').innerText = score;
      dingSound.currentTime = 0;
      dingSound.play();
      obstacleSpeed += 0.05; // gradually faster
    }
  });
}

// Collision effect: shake + particles
function collisionEffect(el) {
  hitSound.currentTime = 0;
  hitSound.play();
  el.style.transform = 'scale(1.3)';
  createParticles(el.offsetLeft + el.offsetWidth/2, el.offsetTop + el.offsetHeight/2);
  setTimeout(() => el.style.transform = 'scale(1)', 200);
}

// Create particles
function createParticles(x, y) {
  for(let i=0; i<20; i++){
    const p = document.createElement('div');
    p.classList.add('particle');
    const dx = (Math.random() - 0.5) * 100 + 'px';
    const dy = (Math.random() - 0.5) * 100 + 'px';
    p.style.left = x + 'px';
    p.style.top = y + 'px';
    p.style.background = `hsl(${Math.random()*360}, 80%, 50%)`;
    p.style.setProperty('--dx', dx);
    p.style.setProperty('--dy', dy);
    gameContainer.appendChild(p);
    setTimeout(() => p.remove(), 600);
  }
}

// Collision detection
function isColliding(a, b) {
  const rect1 = a.getBoundingClientRect();
  const rect2 = b.getBoundingClientRect();
  return !(
    rect1.top > rect2.bottom ||
    rect1.bottom < rect2.top ||
    rect1.left > rect2.right ||
    rect1.right < rect2.left
  );
}

// Player movement
document.addEventListener('keydown', e => {
  if (!gameRunning) return;
  const left = parseInt(player.style.left);
  if (e.key === 'ArrowLeft' && left > 0) {
    player.style.left = Math.max(0, left - playerSpeed) + 'px';
  } else if (e.key === 'ArrowRight' && left < gameContainer.clientWidth - 50) {
    player.style.left = Math.min(gameContainer.clientWidth - 50, left + playerSpeed) + 'px';
  }
});

// End game
function endGame() {
  gameRunning = false;
  clearInterval(gameInterval);
  clearInterval(obstacleInterval);
  obstacles.forEach(o => o.element.remove());
  obstacles = [];
  startButton.style.display = 'inline-block';
  if(score > highScore){
    highScore = score;
    localStorage.setItem('dodgeHighScore', highScore);
    document.getElementById('highScore').innerText = highScore;
    alert(`ðŸŽ‰ New High Score: ${score}!`);
  } else {
    alert(`ðŸ’¥ Game Over! Score: ${score}`);
  }
  obstacleSpeed = 4;
}

startButton.addEventListener('click', startGame);
</script>

</body>
</html>

